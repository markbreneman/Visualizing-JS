<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="charset=utf-8" />
		<link rel="stylesheet" type="text/css" href="styles/base.css" />
		<title>VisualizingJS -Bounce ref</title>
	</head>
	<body>
		<canvas id="myCanvas" width="600" height="600"></canvas>
		<script charset="utf-8" src="scripts/paper.js"></script>
		<script charset="utf-8" src="scripts/skip.js"></script>
		<script charset="utf-8" type="text/paperscript" canvas="myCanvas">

        var balls = [];
        var group = new Group();

        var Ball = Base.extend({
            initialize: function(point, vector) {
                if (!vector || vector.isZero()) {
                    this.vector = Point.random() * 5;
                } else {
                    this.vector = vector * 2;
                }
                this.point = point;
                this.dampen = 0.4;
                this.gravity = 3;
                this.bounce = -0.6;
                this.radius = 50 * Math.random() + 30;
                this.createPaths();
                group.addChild(this.item);
            },

            createPaths: function() {
                var overlayPos = this.point + this.radius / 8;
                var compound = new Path.Circle(this.point, this.radius);
                var color = new HsbColor(Math.random() * 360, 1, 1);
            },

            iterate: function() {
                var size = view.size;
                this.vector.y += this.gravity;
                this.vector.x *= 1;
                var pre = this.point + this.vector;
                if (pre.x < this.radius || pre.x > size.width - this.radius)
                    this.vector.x *= -this.dampen; 
                if (pre.y < this.radius || pre.y > size.height - this.radius) {
                    if (Math.abs(this.vector.x) < 3)
                        this.vector = Point.random() * [150, 100] + [-75, 20];
                    this.vector.y *= this.bounce;
                }

                var max = Point.max(this.radius, this.point + this.vector);
                this.item.position = this.point = Point.min(max, size - this.radius);
                this.item.rotate(this.vector.x / 2);
            }
        });

        for (var i = 0; i < 10; i++) {
            var position = Point.random() * view.size,
                vector = (Point.random() - [0.5, 0]) * [50, 100],
                ball = new Ball(position, vector);
            balls.push(ball);
        }

     
        

        function onFrame() {
            for (var i = 0, l = balls.length; i < l; i++)
                balls[i].iterate();
        }
        </script>
	</body>
</html>		